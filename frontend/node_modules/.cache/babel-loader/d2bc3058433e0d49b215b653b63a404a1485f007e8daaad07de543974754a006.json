{"ast":null,"code":"import _objectSpread from\"C:/Users/vivek/Ecotrack/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";const API_BASE_URL=process.env.REACT_APP_API_URL||'http://localhost:5000/api';// Helper function to get auth token\nconst getAuthToken=()=>{return localStorage.getItem('token');};// Helper function to make authenticated requests\nconst makeRequest=async function(url){let options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const token=getAuthToken();const config=_objectSpread({headers:_objectSpread(_objectSpread({'Content-Type':'application/json'},token&&{'x-auth-token':token}),options.headers)},options);const response=await fetch(\"\".concat(API_BASE_URL).concat(url),config);if(!response.ok){const error=await response.json();throw new Error(error.message||'Something went wrong');}return response.json();};// Auth API\nexport const authAPI={register:async(email,password)=>{const response=await makeRequest('/auth/register',{method:'POST',body:JSON.stringify({email,password})});if(response.token){localStorage.setItem('token',response.token);}return response;},login:async(email,password)=>{const response=await makeRequest('/auth/login',{method:'POST',body:JSON.stringify({email,password})});if(response.token){localStorage.setItem('token',response.token);}return response;},getProfile:async()=>{return makeRequest('/auth/me');},updateGoal:async target_kg=>{return makeRequest('/auth/goal',{method:'PUT',body:JSON.stringify({target_kg})});},logout:()=>{localStorage.removeItem('token');}};// Activities API\nexport const activitiesAPI={logActivity:async(type,data)=>{return makeRequest('/activities',{method:'POST',body:JSON.stringify({type,data})});},getMyActivities:async()=>{return makeRequest('/activities/me');}};// Leaderboard API\nexport const leaderboardAPI={getLeaderboard:async()=>{return makeRequest('/leaderboard');}};// Check if user is authenticated\nexport const isAuthenticated=()=>{const token=getAuthToken();if(!token)return false;try{// Check if token is expired (basic check)\nconst payload=JSON.parse(atob(token.split('.')[1]));return payload.exp*1000>Date.now();}catch(_unused){return false;}};","map":{"version":3,"names":["API_BASE_URL","process","env","REACT_APP_API_URL","getAuthToken","localStorage","getItem","makeRequest","url","options","arguments","length","undefined","token","config","_objectSpread","headers","response","fetch","concat","ok","error","json","Error","message","authAPI","register","email","password","method","body","JSON","stringify","setItem","login","getProfile","updateGoal","target_kg","logout","removeItem","activitiesAPI","logActivity","type","data","getMyActivities","leaderboardAPI","getLeaderboard","isAuthenticated","payload","parse","atob","split","exp","Date","now","_unused"],"sources":["C:/Users/vivek/Ecotrack/frontend/src/services/api.js"],"sourcesContent":["const API_BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000/api';\r\n\r\n// Helper function to get auth token\r\nconst getAuthToken = () => {\r\n  return localStorage.getItem('token');\r\n};\r\n\r\n// Helper function to make authenticated requests\r\nconst makeRequest = async (url, options = {}) => {\r\n  const token = getAuthToken();\r\n  \r\n  const config = {\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...(token && { 'x-auth-token': token }),\r\n      ...options.headers,\r\n    },\r\n    ...options,\r\n  };\r\n\r\n  const response = await fetch(`${API_BASE_URL}${url}`, config);\r\n  \r\n  if (!response.ok) {\r\n    const error = await response.json();\r\n    throw new Error(error.message || 'Something went wrong');\r\n  }\r\n  \r\n  return response.json();\r\n};\r\n\r\n// Auth API\r\nexport const authAPI = {\r\n  register: async (email, password) => {\r\n    const response = await makeRequest('/auth/register', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ email, password }),\r\n    });\r\n    \r\n    if (response.token) {\r\n      localStorage.setItem('token', response.token);\r\n    }\r\n    \r\n    return response;\r\n  },\r\n\r\n  login: async (email, password) => {\r\n    const response = await makeRequest('/auth/login', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ email, password }),\r\n    });\r\n    \r\n    if (response.token) {\r\n      localStorage.setItem('token', response.token);\r\n    }\r\n    \r\n    return response;\r\n  },\r\n\r\n  getProfile: async () => {\r\n    return makeRequest('/auth/me');\r\n  },\r\n\r\n  updateGoal: async (target_kg) => {\r\n    return makeRequest('/auth/goal', {\r\n      method: 'PUT',\r\n      body: JSON.stringify({ target_kg }),\r\n    });\r\n  },\r\n\r\n  logout: () => {\r\n    localStorage.removeItem('token');\r\n  },\r\n};\r\n\r\n// Activities API\r\nexport const activitiesAPI = {\r\n  logActivity: async (type, data) => {\r\n    return makeRequest('/activities', {\r\n      method: 'POST',\r\n      body: JSON.stringify({ type, data }),\r\n    });\r\n  },\r\n\r\n  getMyActivities: async () => {\r\n    return makeRequest('/activities/me');\r\n  },\r\n};\r\n\r\n// Leaderboard API\r\nexport const leaderboardAPI = {\r\n  getLeaderboard: async () => {\r\n    return makeRequest('/leaderboard');\r\n  },\r\n};\r\n\r\n// Check if user is authenticated\r\nexport const isAuthenticated = () => {\r\n  const token = getAuthToken();\r\n  if (!token) return false;\r\n  \r\n  try {\r\n    // Check if token is expired (basic check)\r\n    const payload = JSON.parse(atob(token.split('.')[1]));\r\n    return payload.exp * 1000 > Date.now();\r\n  } catch {\r\n    return false;\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}